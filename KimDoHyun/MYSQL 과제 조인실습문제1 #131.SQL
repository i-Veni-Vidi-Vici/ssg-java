--1번
select case WEEKDAY('20201225')
    when '0' then '월요일'
    when '1' then '화요일'
    when '2' then '수요일'
    when '3' then '목요일'
    when '4' then '금요일'
    when '5' then '토요일'
    when '6' then '일요일'
    end as dayofweek;
--2번
select  R.EMP_ID,R.EMP_NAME, R.age, DEPT_TITLE, DEPT_ID FROM DEPARTMENT AS T
join (SELECT EMP_ID, JOB_CODE, DEPT_CODE, EMP_NAME ,year(now()) - (if(mid(EMP_NO, 8, 1) = '1' or mid(EMP_NO, 8, 1) = '2', 1900, 2000) + left(EMP_NO, 2)) + 1 as age
FROM EMPLOYEE) as R
    ON R.DEPT_CODE = T.DEPT_ID
JOIN (SELECT JOB_CODE, JOB_NAME FROM JOB) AS Y
ON R.JOB_CODE = Y.JOB_CODE
ORDER BY R.age asc
limit 1;
--3번
select T.EMP_NAME, R.DEPT_TITLE, Y.JOB_NAME
FROM EMPLOYEE as T
join (SELECT DEPT_ID, DEPT_TITLE
FROM DEPARTMENT) as R
    ON R.DEPT_ID = T.DEPT_CODE
JOIN (SELECT JOB_CODE, JOB_NAME FROM JOB) AS Y
ON T.JOB_CODE = Y.JOB_CODE
WHERE T.EMP_NAME LIKE '%형%';
--4번
select T.EMP_NAME, R.DEPT_TITLE,R.DEPT_ID, Y.JOB_NAME
FROM EMPLOYEE as T
join (SELECT DEPT_ID, DEPT_TITLE
FROM DEPARTMENT) as R
    ON R.DEPT_ID = T.DEPT_CODE
JOIN (SELECT JOB_CODE, JOB_NAME FROM JOB) AS Y
ON T.JOB_CODE = Y.JOB_CODE
WHERE DEPT_TITLE LIKE '해외영업%'
-- 5번
select T.EMP_NAME,T.BONUS,  Y.LOCAL_NAME
FROM EMPLOYEE as T
join (SELECT DEPT_ID,LOCATION_ID
FROM DEPARTMENT) as R
    ON R.DEPT_ID = T.DEPT_CODE
JOIN (SELECT LOCAL_CODE, LOCAL_NAME FROM LOCATION) AS Y
ON R.LOCATION_ID = Y.LOCAL_CODE
WHERE T.BONUS IS NOT NULL
--6번
select T.EMP_NAME,U.JOB_NAME,R.DEPT_TITLE ,Y.LOCAL_NAME
FROM EMPLOYEE as T
join (SELECT DEPT_ID,DEPT_TITLE,LOCATION_ID
FROM DEPARTMENT
WHERE DEPT_ID = 'D2') as R
    ON R.DEPT_ID = T.DEPT_CODE
JOIN (SELECT LOCAL_CODE, LOCAL_NAME FROM LOCATION) AS Y
ON R.LOCATION_ID = Y.LOCAL_CODE
JOIN (SELECT JOB_CODE, JOB_NAME FROM JOB) AS U
ON T.JOB_CODE = U.JOB_CODE
--7번
select T.EMP_NAME , I.JOB_NAME, T.SALARY
FROM EMPLOYEE as T
JOIN (SELECT SAL_LEVEL, MAX_SAL FROM SAL_GRADE) AS U
ON T.SAL_LEVEL = U.SAL_LEVEL
JOIN (SELECT JOB_CODE,JOB_NAME FROM JOB) AS I
ON I.JOB_CODE = T.JOB_CODE
WHERE T.SALARY > U.MAX_SAL
--8번
select T.EMP_NAME ,U.DEPT_TITLE,I.LOCAL_NAME,O.NATIONAL_NAME
FROM EMPLOYEE as T
JOIN (SELECT LOCATION_ID,DEPT_ID, DEPT_TITLE FROM DEPARTMENT) AS U
ON T.DEPT_CODE = U.DEPT_ID
JOIN (SELECT LOCAL_CODE,LOCAL_NAME,NATIONAL_CODE FROM LOCATION) AS I
ON U.LOCATION_ID = I.LOCAL_CODE
JOIN (select NATIONAL_CODE, NATIONAL_NAME FROM NATION) AS O
ON O.NATIONAL_CODE = I.NATIONAL_CODE
WHERE O.NATIONAL_CODE = 'KO' OR O.NATIONAL_CODE = 'JP'
--9번
SELECT
    E1.EMP_NAME ,
    D.DEPT_TITLE ,
    E2.EMP_NAME
FROM
    EMPLOYEE E1
JOIN
    EMPLOYEE E2 ON E1.DEPT_CODE <> E2.DEPT_CODE AND E1.EMP_ID <> E2.EMP_ID
JOIN
    DEPARTMENT D ON E1.DEPT_CODE = D.DEPT_ID
WHERE
    E1.QUIT_YN = 'N' AND E2.QUIT_YN = 'N';
--10번
SELECT EMP.EMP_NAME,J2.JOB_NAME,SALARY FROM EMPLOYEE AS EMP
JOIN JOB J2 ON J2.JOB_CODE = EMP.JOB_CODE
 WHERE EMP.BONUS IS NULL
 AND JOB_NAME IN('차장','사원');
 --11번
 SELECT
    SUM(CASE WHEN QUIT_YN = 'Y' THEN 1 ELSE 0 END) AS QuitCount,
    SUM(CASE WHEN QUIT_YN = 'N' THEN 1 ELSE 0 END) AS ActiveCount
FROM
    EMPLOYEE;




